// Exploit.cpp : This file contains the 'main' function. Program execution begins and ends there.
//

#include "pch.h"
#include <iostream>
#include <fstream>
#include <windows.h>
#include <stdio.h>

int main()
{
	char buffer[1024]{};
	::sprintf_s(buffer, "StackOverflow.exe shellcode.bin");
	//::sprintf_s(buffer, "ROP.exe ROP.bin");

	STARTUPINFOA si{};
	si.cb = sizeof(si);
	PROCESS_INFORMATION pi{};

	DWORD error{};
	if (!::CreateProcessA(nullptr, buffer, nullptr, nullptr, FALSE, 0, nullptr, nullptr, &si, &pi)) {
		DWORD error = GetLastError();
		std::cout << "Failed to create process, error " << error << std::endl;
		return -1;
	}

	WaitForSingleObject(pi.hProcess, INFINITE);
	CloseHandle(pi.hProcess);
	CloseHandle(pi.hThread);
	return error;
}
